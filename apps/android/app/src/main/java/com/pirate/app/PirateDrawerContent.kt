package com.pirate.app

import androidx.compose.material3.DrawerState
import androidx.compose.runtime.Composable
import androidx.compose.runtime.rememberCoroutineScope
import androidx.navigation.NavHostController
import com.pirate.app.ui.PirateSideMenuDrawer
import kotlinx.coroutines.launch

@Composable
internal fun PirateDrawerContent(
  drawerState: DrawerState,
  navController: NavHostController,
  isAuthenticated: Boolean,
  busy: Boolean,
  ethAddress: String?,
  heavenName: String?,
  avatarUri: String?,
  selfVerified: Boolean,
  onRegister: suspend () -> Unit,
  onLogin: suspend () -> Unit,
  onLogout: suspend () -> Unit,
) {
  val scope = rememberCoroutineScope()

  suspend fun closeDrawer() {
    drawerState.close()
  }

  PirateSideMenuDrawer(
    isAuthenticated = isAuthenticated,
    busy = busy,
    ethAddress = ethAddress,
    heavenName = heavenName,
    avatarUri = avatarUri,
    selfVerified = selfVerified,
    onNavigateProfile = {
      scope.launch {
        closeDrawer()
        navController.navigate(PirateRoute.Profile.route) {
          popUpTo(navController.graph.startDestinationId) { saveState = true }
          launchSingleTop = true
          restoreState = true
        }
      }
    },
    onNavigateWallet = {
      scope.launch {
        closeDrawer()
        navController.navigate(PirateRoute.Wallet.route) { launchSingleTop = true }
      }
    },
    onNavigateNameStore = {
      scope.launch {
        closeDrawer()
        navController.navigate(PirateRoute.NameStore.route) { launchSingleTop = true }
      }
    },
    onNavigateVerifyIdentity = {
      scope.launch {
        closeDrawer()
        navController.navigate(PirateRoute.VerifyIdentity.route) { launchSingleTop = true }
      }
    },
    onNavigatePublish = {
      scope.launch {
        closeDrawer()
        navController.navigate(PirateRoute.Publish.route) { launchSingleTop = true }
      }
    },
    onSignUp = {
      scope.launch {
        closeDrawer()
        onRegister()
      }
    },
    onSignIn = {
      scope.launch {
        closeDrawer()
        onLogin()
      }
    },
    onLogout = {
      scope.launch {
        closeDrawer()
        onLogout()
      }
    },
  )
}
