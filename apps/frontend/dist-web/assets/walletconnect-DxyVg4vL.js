const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C1KVgD25.js","assets/index-BpYvc_Sf.js","assets/index-Hzvnd9dX.css"])))=>i.map(i=>d[i]);
import{_ as v,b as r,c as l,m as d}from"./index-BpYvc_Sf.js";import{c as u}from"./createWalletClient-CORmUUYT.js";const p="ce42103ef9ca7f760e736b44f32e20b7";let o=null,t=null;async function w(){if(o&&o.session&&t)return console.log("[WC] Reusing active WalletConnect session"),t;console.log("[WC] Importing EthereumProvider...");const{EthereumProvider:m}=await v(async()=>{const{EthereumProvider:n}=await import("./index-C1KVgD25.js").then(s=>s.L);return{EthereumProvider:n}},__vite__mapDeps([0,1,2])),e=await m.init({projectId:p,chains:[1],showQrModal:!0,metadata:{name:"Heaven",description:"Heaven Desktop App",url:"https://dotheaven.org",icons:["https://dotheaven.org/images/heaven.png"]}});if(e.session){console.log("[WC] Restored existing session for",e.accounts[0]),o=e;const n=r(e.accounts[0]);return t=u({account:n,chain:d,transport:l(e)}),t}console.log("[WC] No existing session, showing QR..."),e.on("display_uri",n=>{console.log("[WC] display_uri fired, QR URI:",(n==null?void 0:n.slice(0,60))+"...")}),e.on("connect",()=>console.log("[WC] connect event fired")),e.on("disconnect",()=>console.log("[WC] disconnect event fired"));const h=e.enable(),g=new Promise((n,s)=>setTimeout(()=>s(new Error("WalletConnect timed out after 30s â€” relay may be down")),3e4));await Promise.race([h,g]),console.log("[WC] enable() resolved, connected"),o=e;const a=e.accounts;if(!a.length)throw new Error("No accounts returned from WalletConnect");const C=r(a[0]),i=u({account:C,chain:d,transport:l(e)});t=i;const c=()=>{o=null,t=null};return e.on("disconnect",c),e.on("accountsChanged",c),e.on("chainChanged",c),i}async function _(){if(o){try{await o.disconnect()}catch{}o=null,t=null}}export{w as connectWalletConnect,_ as disconnectWalletConnect};
