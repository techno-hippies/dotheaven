name = "heaven-images"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Rules for bundling WASM modules (svg2png-wasm)
[[rules]]
type = "CompiledWasm"
globs = ["**/*.wasm"]

# Rules for font files (binary data)
[[rules]]
type = "Data"
globs = ["**/*.ttf", "**/*.otf", "**/*.woff", "**/*.woff2"]

[vars]
ENVIRONMENT = "development"

# Images binding for transforms (resize, watermark compositing)
[images]
binding = "IMAGES"

# Secrets (set via `wrangler secret put`):
# - FILEBASE_API_KEY
# - OPENROUTER_API_KEY
# - FAL_API_KEY
# - WATERMARK_SECRET (HMAC key for watermark codes)

[env.production]
vars = { ENVIRONMENT = "production" }

[env.production.images]
binding = "IMAGES"
